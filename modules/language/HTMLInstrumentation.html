<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <link rel="stylesheet" href="..&#x2F;../assets/css/bootstrap.css">
        <link rel="stylesheet" href="..&#x2F;../assets/css/typeahead.js-bootstrap.css">
        <link rel="stylesheet" href="..&#x2F;../assets/css/font-awesome.css">
        <link rel="stylesheet" href="..&#x2F;../assets/css/highlight.css">
        <link rel="stylesheet" href="..&#x2F;../assets/css/main.css">
        <!--[if IE 7]>
        <link rel="stylesheet" href="../assets/css/font-awesome-ie7.css">
        <![endif]-->
        <script type="text/javascript" src="..&#x2F;../assets/js/jquery-1.9.1.js"></script>
        <script type="text/javascript" src="..&#x2F;../assets/js/bootstrap.js"></script>
        <script type="text/javascript" src="..&#x2F;../assets/js/typeahead.js"></script>
        <script type="text/javascript" src="..&#x2F;../assets/js/highlight.pack.js"></script>
        <script type="text/javascript" src="..&#x2F;../assets/js/main.js"></script>
        
        <script>
            window.moduleLevel = "../..";
        </script>
    </head>
    <body>
        <div class="row-fluid">
            <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="brand" href="..&#x2F;../index.html">Brackets API</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li><a href="#dependencies">Dependencies</a></li>
                    <li><a href="#variables">Variables</a></li>
                    <li><a href="#functions">Functions</a></li>
                    <li><a href="#classes">Classes</a></li>
                </ul>
            </div>
            <input class="typeahead" placeholder="Search..." type="text" >
        </div>
    </div>
</div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span12">
                    <div class="page-header">
                        <h1>HTMLInstrumentation</h1>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span3">
                    <div class="left-section">
                        <ul class="nav nav-list">
    <li class="nav-header">
        <a href="#" id="toggle-other-modules"><i class="icon-folder-close"></i> Modules (190)</a>
    </li>
</ul>
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_"><i class="icon-folder-open"></i></a>
    </li>
</ul>
<ul id="package_" class="nav nav-list">
    <li><a href="..&#x2F;../modules/brackets.html">brackets</a></li>
    <li><a href="..&#x2F;../modules/dependencies.html">dependencies</a></li>
    <li><a href="..&#x2F;../modules/main.html">main</a></li>
    <li><a href="..&#x2F;../modules/strings.html">strings</a></li>
    <li><a href="..&#x2F;../modules/xorigin.html">xorigin</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_command"><i class="icon-folder-open"></i>command</a>
    </li>
</ul>
<ul id="package_command" class="nav nav-list">
    <li><a href="..&#x2F;../modules/command&#x2F;CommandManager.html">CommandManager</a></li>
    <li><a href="..&#x2F;../modules/command&#x2F;Commands.html">Commands</a></li>
    <li><a href="..&#x2F;../modules/command&#x2F;DefaultMenus.html">DefaultMenus</a></li>
    <li><a href="..&#x2F;../modules/command&#x2F;KeyBindingManager.html">KeyBindingManager</a></li>
    <li><a href="..&#x2F;../modules/command&#x2F;Menus.html">Menus</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_document"><i class="icon-folder-open"></i>document</a>
    </li>
</ul>
<ul id="package_document" class="nav nav-list">
    <li><a href="..&#x2F;../modules/document&#x2F;ChangedDocumentTracker.html">ChangedDocumentTracker</a></li>
    <li><a href="..&#x2F;../modules/document&#x2F;Document.html">Document</a></li>
    <li><a href="..&#x2F;../modules/document&#x2F;DocumentCommandHandlers.html">DocumentCommandHandlers</a></li>
    <li><a href="..&#x2F;../modules/document&#x2F;DocumentManager.html">DocumentManager</a></li>
    <li><a href="..&#x2F;../modules/document&#x2F;InMemoryFile.html">InMemoryFile</a></li>
    <li><a href="..&#x2F;../modules/document&#x2F;TextRange.html">TextRange</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_editor"><i class="icon-folder-open"></i>editor</a>
    </li>
</ul>
<ul id="package_editor" class="nav nav-list">
    <li><a href="..&#x2F;../modules/editor&#x2F;CodeHintList.html">CodeHintList</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;CodeHintManager.html">CodeHintManager</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;CSSInlineEditor.html">CSSInlineEditor</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;Editor.html">Editor</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;EditorCommandHandlers.html">EditorCommandHandlers</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;EditorManager.html">EditorManager</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;EditorOptionHandlers.html">EditorOptionHandlers</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;EditorStatusBar.html">EditorStatusBar</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;ImageViewer.html">ImageViewer</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;InlineTextEditor.html">InlineTextEditor</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;InlineWidget.html">InlineWidget</a></li>
    <li><a href="..&#x2F;../modules/editor&#x2F;MultiRangeInlineEditor.html">MultiRangeInlineEditor</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensibility"><i class="icon-folder-open"></i>extensibility</a>
    </li>
</ul>
<ul id="package_extensibility" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensibility&#x2F;ExtensionManager.html">ExtensionManager</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;ExtensionManagerDialog.html">ExtensionManagerDialog</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;ExtensionManagerView.html">ExtensionManagerView</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;ExtensionManagerViewModel.html">ExtensionManagerViewModel</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;InstallExtensionDialog.html">InstallExtensionDialog</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;Package.html">Package</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;registry_utils.html">registry_utils</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensibility_node"><i class="icon-folder-open"></i>extensibility.node</a>
    </li>
</ul>
<ul id="package_extensibility_node" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensibility&#x2F;node&#x2F;ExtensionManagerDomain.html">ExtensionManagerDomain</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;node&#x2F;package-validator.html">package-validator</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensibility_node_spec"><i class="icon-folder-open"></i>extensibility.node.spec</a>
    </li>
</ul>
<ul id="package_extensibility_node_spec" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensibility&#x2F;node&#x2F;spec&#x2F;Installation.spec.html">Installation.spec</a></li>
    <li><a href="..&#x2F;../modules/extensibility&#x2F;node&#x2F;spec&#x2F;Validation.spec.html">Validation.spec</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_CloseOthers"><i class="icon-folder-open"></i>extensions.default.CloseOthers</a>
    </li>
</ul>
<ul id="package_extensions_default_CloseOthers" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;CloseOthers&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_CSSCodeHints"><i class="icon-folder-open"></i>extensions.default.CSSCodeHints</a>
    </li>
</ul>
<ul id="package_extensions_default_CSSCodeHints" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;CSSCodeHints&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_DebugCommands"><i class="icon-folder-open"></i>extensions.default.DebugCommands</a>
    </li>
</ul>
<ul id="package_extensions_default_DebugCommands" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;DebugCommands&#x2F;main.html">main</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;DebugCommands&#x2F;NodeDebugUtils.html">NodeDebugUtils</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_HTMLCodeHints"><i class="icon-folder-open"></i>extensions.default.HTMLCodeHints</a>
    </li>
</ul>
<ul id="package_extensions_default_HTMLCodeHints" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;HTMLCodeHints&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_HtmlEntityCodeHints"><i class="icon-folder-open"></i>extensions.default.HtmlEntityCodeHints</a>
    </li>
</ul>
<ul id="package_extensions_default_HtmlEntityCodeHints" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;HtmlEntityCodeHints&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_InlineColorEditor"><i class="icon-folder-open"></i>extensions.default.InlineColorEditor</a>
    </li>
</ul>
<ul id="package_extensions_default_InlineColorEditor" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineColorEditor&#x2F;ColorEditor.html">ColorEditor</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineColorEditor&#x2F;InlineColorEditor.html">InlineColorEditor</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineColorEditor&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_InlineTimingFunctionEditor"><i class="icon-folder-open"></i>extensions.default.InlineTimingFunctionEditor</a>
    </li>
</ul>
<ul id="package_extensions_default_InlineTimingFunctionEditor" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineTimingFunctionEditor&#x2F;BezierCurveEditor.html">BezierCurveEditor</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineTimingFunctionEditor&#x2F;InlineTimingFunctionEditor.html">InlineTimingFunctionEditor</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineTimingFunctionEditor&#x2F;main.html">main</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineTimingFunctionEditor&#x2F;StepEditor.html">StepEditor</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;InlineTimingFunctionEditor&#x2F;TimingFunctionUtils.html">TimingFunctionUtils</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_JavaScriptCodeHints"><i class="icon-folder-open"></i>extensions.default.JavaScriptCodeHints</a>
    </li>
</ul>
<ul id="package_extensions_default_JavaScriptCodeHints" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;HintUtils.html">HintUtils</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;HintUtils2.html">HintUtils2</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;main.html">main</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;MessageIds.html">MessageIds</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;ParameterHintManager.html">ParameterHintManager</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;Preferences.html">Preferences</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;ScopeManager.html">ScopeManager</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;Session.html">Session</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptCodeHints&#x2F;tern-worker.html">tern-worker</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_JavaScriptQuickEdit"><i class="icon-folder-open"></i>extensions.default.JavaScriptQuickEdit</a>
    </li>
</ul>
<ul id="package_extensions_default_JavaScriptQuickEdit" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JavaScriptQuickEdit&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_JSLint"><i class="icon-folder-open"></i>extensions.default.JSLint</a>
    </li>
</ul>
<ul id="package_extensions_default_JSLint" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;JSLint&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_LESSSupport"><i class="icon-folder-open"></i>extensions.default.LESSSupport</a>
    </li>
</ul>
<ul id="package_extensions_default_LESSSupport" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;LESSSupport&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_QuickOpenCSS"><i class="icon-folder-open"></i>extensions.default.QuickOpenCSS</a>
    </li>
</ul>
<ul id="package_extensions_default_QuickOpenCSS" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;QuickOpenCSS&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_QuickOpenHTML"><i class="icon-folder-open"></i>extensions.default.QuickOpenHTML</a>
    </li>
</ul>
<ul id="package_extensions_default_QuickOpenHTML" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;QuickOpenHTML&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_QuickOpenJavaScript"><i class="icon-folder-open"></i>extensions.default.QuickOpenJavaScript</a>
    </li>
</ul>
<ul id="package_extensions_default_QuickOpenJavaScript" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;QuickOpenJavaScript&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_QuickView"><i class="icon-folder-open"></i>extensions.default.QuickView</a>
    </li>
</ul>
<ul id="package_extensions_default_QuickView" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;QuickView&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_RecentProjects"><i class="icon-folder-open"></i>extensions.default.RecentProjects</a>
    </li>
</ul>
<ul id="package_extensions_default_RecentProjects" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;RecentProjects&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_StaticServer"><i class="icon-folder-open"></i>extensions.default.StaticServer</a>
    </li>
</ul>
<ul id="package_extensions_default_StaticServer" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;StaticServer&#x2F;main.html">main</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;StaticServer&#x2F;StaticServer.html">StaticServer</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_StaticServer_node"><i class="icon-folder-open"></i>extensions.default.StaticServer.node</a>
    </li>
</ul>
<ul id="package_extensions_default_StaticServer_node" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;StaticServer&#x2F;node&#x2F;StaticServerDomain.html">StaticServerDomain</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_UrlCodeHints"><i class="icon-folder-open"></i>extensions.default.UrlCodeHints</a>
    </li>
</ul>
<ul id="package_extensions_default_UrlCodeHints" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;UrlCodeHints&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_UrlCodeHints_testfiles_subfolder"><i class="icon-folder-open"></i>extensions.default.UrlCodeHints.testfiles.subfolder</a>
    </li>
</ul>
<ul id="package_extensions_default_UrlCodeHints_testfiles_subfolder" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;UrlCodeHints&#x2F;testfiles&#x2F;subfolder&#x2F;test.html">test</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_default_WebPlatformDocs"><i class="icon-folder-open"></i>extensions.default.WebPlatformDocs</a>
    </li>
</ul>
<ul id="package_extensions_default_WebPlatformDocs" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;WebPlatformDocs&#x2F;InlineDocsViewer.html">InlineDocsViewer</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;default&#x2F;WebPlatformDocs&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_samples_circular_dependency_test"><i class="icon-folder-open"></i>extensions.samples.circular_dependency_test</a>
    </li>
</ul>
<ul id="package_extensions_samples_circular_dependency_test" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;circular_dependency_test&#x2F;main.html">main</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;circular_dependency_test&#x2F;secondary.html">secondary</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_samples_ContextMenuTest"><i class="icon-folder-open"></i>extensions.samples.ContextMenuTest</a>
    </li>
</ul>
<ul id="package_extensions_samples_ContextMenuTest" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;ContextMenuTest&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_samples_InlineImageViewer"><i class="icon-folder-open"></i>extensions.samples.InlineImageViewer</a>
    </li>
</ul>
<ul id="package_extensions_samples_InlineImageViewer" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;InlineImageViewer&#x2F;InlineImageViewer.html">InlineImageViewer</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;InlineImageViewer&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_samples_LocalizationExample"><i class="icon-folder-open"></i>extensions.samples.LocalizationExample</a>
    </li>
</ul>
<ul id="package_extensions_samples_LocalizationExample" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;LocalizationExample&#x2F;main.html">main</a></li>
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;LocalizationExample&#x2F;strings.html">strings</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_extensions_samples_TypingSpeedLogger"><i class="icon-folder-open"></i>extensions.samples.TypingSpeedLogger</a>
    </li>
</ul>
<ul id="package_extensions_samples_TypingSpeedLogger" class="nav nav-list">
    <li><a href="..&#x2F;../modules/extensions&#x2F;samples&#x2F;TypingSpeedLogger&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_file"><i class="icon-folder-open"></i>file</a>
    </li>
</ul>
<ul id="package_file" class="nav nav-list">
    <li><a href="..&#x2F;../modules/file&#x2F;FileUtils.html">FileUtils</a></li>
    <li><a href="..&#x2F;../modules/file&#x2F;NativeFileError.html">NativeFileError</a></li>
    <li><a href="..&#x2F;../modules/file&#x2F;NativeFileSystem.html">NativeFileSystem</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_filesystem"><i class="icon-folder-open"></i>filesystem</a>
    </li>
</ul>
<ul id="package_filesystem" class="nav nav-list">
    <li><a href="..&#x2F;../modules/filesystem&#x2F;Directory.html">Directory</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;File.html">File</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;FileIndex.html">FileIndex</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;FileSystem.html">FileSystem</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;FileSystemEntry.html">FileSystemEntry</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;FileSystemError.html">FileSystemError</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;FileSystemStats.html">FileSystemStats</a></li>
    <li><a href="..&#x2F;../modules/filesystem&#x2F;WatchedRoot.html">WatchedRoot</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell"><i class="icon-folder-open"></i>filesystem.impls.appshell</a>
    </li>
</ul>
<ul id="package_filesystem_impls_appshell" class="nav nav-list">
    <li><a href="..&#x2F;../modules/filesystem&#x2F;impls&#x2F;appshell&#x2F;AppshellFileSystem.html">AppshellFileSystem</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell_node"><i class="icon-folder-open"></i>filesystem.impls.appshell.node</a>
    </li>
</ul>
<ul id="package_filesystem_impls_appshell_node" class="nav nav-list">
    <li><a href="..&#x2F;../modules/filesystem&#x2F;impls&#x2F;appshell&#x2F;node&#x2F;FileWatcherDomain.html">FileWatcherDomain</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_help"><i class="icon-folder-open"></i>help</a>
    </li>
</ul>
<ul id="package_help" class="nav nav-list">
    <li><a href="..&#x2F;../modules/help&#x2F;HelpCommandHandlers.html">HelpCommandHandlers</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_language"><i class="icon-folder-open"></i>language</a>
    </li>
</ul>
<ul id="package_language" class="nav nav-list">
    <li><a href="..&#x2F;../modules/language&#x2F;CodeInspection.html">CodeInspection</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;CSSUtils.html">CSSUtils</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;HTMLDOMDiff.html">HTMLDOMDiff</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;HTMLInstrumentation.html">HTMLInstrumentation</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;HTMLSimpleDOM.html">HTMLSimpleDOM</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;HTMLTokenizer.html">HTMLTokenizer</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;HTMLUtils.html">HTMLUtils</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;JSUtils.html">JSUtils</a></li>
    <li><a href="..&#x2F;../modules/language&#x2F;LanguageManager.html">LanguageManager</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Agents"><i class="icon-folder-open"></i>LiveDevelopment.Agents</a>
    </li>
</ul>
<ul id="package_LiveDevelopment_Agents" class="nav nav-list">
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;ConsoleAgent.html">ConsoleAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;CSSAgent.html">CSSAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;DOMAgent.html">DOMAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;DOMHelpers.html">DOMHelpers</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;DOMNode.html">DOMNode</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;EditAgent.html">EditAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;GotoAgent.html">GotoAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;HighlightAgent.html">HighlightAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;NetworkAgent.html">NetworkAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;RemoteAgent.html">RemoteAgent</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;RemoteFunctions.html">RemoteFunctions</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Agents&#x2F;ScriptAgent.html">ScriptAgent</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Documents"><i class="icon-folder-open"></i>LiveDevelopment.Documents</a>
    </li>
</ul>
<ul id="package_LiveDevelopment_Documents" class="nav nav-list">
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Documents&#x2F;CSSDocument.html">CSSDocument</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Documents&#x2F;HTMLDocument.html">HTMLDocument</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Documents&#x2F;JSDocument.html">JSDocument</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Inspector"><i class="icon-folder-open"></i>LiveDevelopment.Inspector</a>
    </li>
</ul>
<ul id="package_LiveDevelopment_Inspector" class="nav nav-list">
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Inspector&#x2F;Inspector.html">Inspector</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment"><i class="icon-folder-open"></i>LiveDevelopment</a>
    </li>
</ul>
<ul id="package_LiveDevelopment" class="nav nav-list">
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;LiveDevelopment.html">LiveDevelopment</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;LiveDevServerManager.html">LiveDevServerManager</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;main.html">main</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Servers"><i class="icon-folder-open"></i>LiveDevelopment.Servers</a>
    </li>
</ul>
<ul id="package_LiveDevelopment_Servers" class="nav nav-list">
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Servers&#x2F;BaseServer.html">BaseServer</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Servers&#x2F;FileServer.html">FileServer</a></li>
    <li><a href="..&#x2F;../modules/LiveDevelopment&#x2F;Servers&#x2F;UserServer.html">UserServer</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_preferences"><i class="icon-folder-open"></i>preferences</a>
    </li>
</ul>
<ul id="package_preferences" class="nav nav-list">
    <li><a href="..&#x2F;../modules/preferences&#x2F;PreferencesBase.html">PreferencesBase</a></li>
    <li><a href="..&#x2F;../modules/preferences&#x2F;PreferencesDialogs.html">PreferencesDialogs</a></li>
    <li><a href="..&#x2F;../modules/preferences&#x2F;PreferencesImpl.html">PreferencesImpl</a></li>
    <li><a href="..&#x2F;../modules/preferences&#x2F;PreferencesManager.html">PreferencesManager</a></li>
    <li><a href="..&#x2F;../modules/preferences&#x2F;PreferenceStorage.html">PreferenceStorage</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_project"><i class="icon-folder-open"></i>project</a>
    </li>
</ul>
<ul id="package_project" class="nav nav-list">
    <li><a href="..&#x2F;../modules/project&#x2F;FileIndexManager.html">FileIndexManager</a></li>
    <li><a href="..&#x2F;../modules/project&#x2F;FileSyncManager.html">FileSyncManager</a></li>
    <li><a href="..&#x2F;../modules/project&#x2F;FileViewController.html">FileViewController</a></li>
    <li><a href="..&#x2F;../modules/project&#x2F;ProjectManager.html">ProjectManager</a></li>
    <li><a href="..&#x2F;../modules/project&#x2F;SidebarView.html">SidebarView</a></li>
    <li><a href="..&#x2F;../modules/project&#x2F;WorkingSetSort.html">WorkingSetSort</a></li>
    <li><a href="..&#x2F;../modules/project&#x2F;WorkingSetView.html">WorkingSetView</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_search"><i class="icon-folder-open"></i>search</a>
    </li>
</ul>
<ul id="package_search" class="nav nav-list">
    <li><a href="..&#x2F;../modules/search&#x2F;FileFilters.html">FileFilters</a></li>
    <li><a href="..&#x2F;../modules/search&#x2F;FindInFiles.html">FindInFiles</a></li>
    <li><a href="..&#x2F;../modules/search&#x2F;FindReplace.html">FindReplace</a></li>
    <li><a href="..&#x2F;../modules/search&#x2F;QuickOpen.html">QuickOpen</a></li>
    <li><a href="..&#x2F;../modules/search&#x2F;ScrollTrackMarkers.html">ScrollTrackMarkers</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_utils"><i class="icon-folder-open"></i>utils</a>
    </li>
</ul>
<ul id="package_utils" class="nav nav-list">
    <li><a href="..&#x2F;../modules/utils&#x2F;AnimationUtils.html">AnimationUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;AppInit.html">AppInit</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;Async.html">Async</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;BuildInfoUtils.html">BuildInfoUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;CollectionUtils.html">CollectionUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;ColorUtils.html">ColorUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;DeprecationWarning.html">DeprecationWarning</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;DragAndDrop.html">DragAndDrop</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;DropdownEventHandler.html">DropdownEventHandler</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;ExtensionLoader.html">ExtensionLoader</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;ExtensionUtils.html">ExtensionUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;Global.html">Global</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;KeyEvent.html">KeyEvent</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;NativeApp.html">NativeApp</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;NodeConnection.html">NodeConnection</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;NodeDomain.html">NodeDomain</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;PerfUtils.html">PerfUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;Resizer.html">Resizer</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;ShellAPI.html">ShellAPI</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;StringMatch.html">StringMatch</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;StringUtils.html">StringUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;TokenUtils.html">TokenUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;UpdateNotification.html">UpdateNotification</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;UrlParams.html">UrlParams</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;ValidationUtils.html">ValidationUtils</a></li>
    <li><a href="..&#x2F;../modules/utils&#x2F;ViewUtils.html">ViewUtils</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_view"><i class="icon-folder-open"></i>view</a>
    </li>
</ul>
<ul id="package_view" class="nav nav-list">
    <li><a href="..&#x2F;../modules/view&#x2F;PanelManager.html">PanelManager</a></li>
    <li><a href="..&#x2F;../modules/view&#x2F;ViewCommandHandlers.html">ViewCommandHandlers</a></li>
</ul>                
<ul class="nav nav-list package-list">
    <li class="nav-header">
        <a href="javascript:;" class="toggle-package" data-package="package_widgets"><i class="icon-folder-open"></i>widgets</a>
    </li>
</ul>
<ul id="package_widgets" class="nav nav-list">
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-alerts.html">bootstrap-alerts</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-button.html">bootstrap-button</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-dropdown.html">bootstrap-dropdown</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-modal.html">bootstrap-modal</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-popover.html">bootstrap-popover</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-scrollspy.html">bootstrap-scrollspy</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-tab.html">bootstrap-tab</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-tooltip.html">bootstrap-tooltip</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;bootstrap-twipsy-mod.html">bootstrap-twipsy-mod</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;DefaultDialogs.html">DefaultDialogs</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;Dialogs.html">Dialogs</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;DropdownButton.html">DropdownButton</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;ModalBar.html">ModalBar</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;PopUpManager.html">PopUpManager</a></li>
    <li><a href="..&#x2F;../modules/widgets&#x2F;StatusBar.html">StatusBar</a></li>
</ul>                

                    </div>
                </div>
                <div class="span9">
                    <section>
                        <div id="description">
                            <p>HTMLInstrumentation</p>

<p>This module contains functions for "instrumenting" html code so that we can track<br />the relationship of source code to DOM nodes in the browser. This functionality is<br />used by both live highlighting and live HTML editing.</p>

<p>During live HTML development, the HTML source code is parsed to identify tag boundaries.<br />Each tag is assigned an ID which is stored in markers that are inserted into the editor.<br />These IDs are also included in "data-brackets-id" attributes that are inserted in the<br />HTML code that's served to the browser via the Live Development server.</p>

<p>The primary function for that functionality is generateInstrumentedHTML(). This does just <br />what it says - it will read the HTML content in the doc and generate instrumented code by <br />injecting "data-brackets-id" attributes. Additionally, it caches the parsed DOM for use<br />by future updates.</p>

<p>As the user makes edits in the editor, we determine how the DOM structure should change<br />based on the edits to the source code; those edits are generated by getUnappliedEditList().<br />HTMLDocument (in LiveDevelopment) takes those edits and sends them to the browser (via<br />RemoteFunctions) so that the DOM structure in the live preview can be updated accordingly.</p>

<p>There are also helper functions for returning the tagID associated with a specified<br />position in the document--this is used in live highlighting.</p>
                        </div>
                    </section>
        
                    <section id="dependencies">
                        <h3>Dependencies</h3>
                        
                        <ul class="nav nav-list">
                            <li><a href="..&#x2F;../modules/document&#x2F;DocumentManager.html">DocumentManager</a></li>
                            <li><a href="..&#x2F;../modules/.&#x2F;HTMLSimpleDOM.html">HTMLSimpleDOM</a></li>
                            <li><a href="..&#x2F;../modules/.&#x2F;HTMLDOMDiff.html">HTMLDOMDiff</a></li>
                            <li><a href="..&#x2F;../modules/utils&#x2F;PerfUtils.html">PerfUtils</a></li>
                        </ul>
                        
                        
                    </section>
        
        
                    <section id="functions">
                        <h3>Functions 
                            <label class="checkbox">
                                <input class="toggle-public" type="checkbox"> Show Private Members
                            </label>
                        </h3>
                        
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_dumpMarks</h4>
                            <em><p>Dumps the current list of mark ranges for instrumented tags to the console. Used for debugging.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor to find the mark ranges for.</dd>
                                    <dt>nodeMap</dt>
                                        <span class="label label-optional pull-left">optional</span>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>If specified, a map of tag IDs to DOM nodes, used so we can indicate which tag name the DOM thinks corresponds to the given mark.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _dumpMarks(editor, nodeMap) {
        var markCache = {},
            marks = _getSortedTagMarks(editor._codeMirror.getAllMarks(), markCache);
        marks.forEach(function (markInfo) {
            var mark = markInfo.mark,
                range = markInfo.range;
            console.log(&quot;&lt;&quot; + nodeMap[mark.tagID].tag + &quot;&gt; (&quot; + mark.tagID + &quot;) &quot; +
                        range.from.line + &quot;:&quot; + range.from.ch + &quot; - &quot; + range.to.line + &quot;:&quot; + range.to.ch);
        });
    }</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_getBrowserDiff</h4>
                            <em><p>Diff the browser DOM with the in-editor DOM</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd></dd>
                                    <dt>browserSimpleDOM</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd></dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _getBrowserDiff(editor, browserSimpleDOM) {
        var cachedValue = _cachedValues[editor.document.file.fullPath],
            editorRoot  = cachedValue.dom,
            browserRoot;
        
        browserRoot = _processBrowserSimpleDOM(browserSimpleDOM, editorRoot.tagID);
        
        return {
            diff    : HTMLDOMDiff.domdiff(editorRoot, browserRoot),
            browser : browserRoot,
            editor  : editorRoot
        };
    }
    
    $(DocumentManager).on(&quot;beforeDocumentDelete&quot;, _removeDocFromCache);</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_getMarkerAtDocumentPos</h4>
                            <em><p>Finds the mark for the DOM node at the given position in the editor.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor containing the instrumented document.</dd>
                                    <dt>pos</dt>
                                    <dd class="label label-info pull-left">{line: number,ch: number}</dd>
                                    <dd>The position to find the DOM marker for.</dd>
                                    <dt>preferParent</dt>
                                    <dd class="label label-info pull-left">boolean</dd>
                                    <dd>If true, and the pos is at one or the other edge of the innermost marked range, return the immediately enclosing mark instead.</dd>
                                    <dt>markCache</dt>
                                        <span class="label label-optional pull-left">optional</span>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>An optional cache to look up positions of existing markers. (This avoids calling the find() operation on marks multiple times, which is expensive.)</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _getMarkerAtDocumentPos(editor, pos, preferParent, markCache) {
        var i, marks, match;
        
        markCache = markCache || {};
        marks = _getSortedTagMarks(editor._codeMirror.findMarksAt(pos), markCache);
        if (!marks.length) {
            return null;
        }
        
        &#x2F;&#x2F; The mark with the latest start is the innermost one.
        match = marks[marks.length - 1];
        if (preferParent) {
            &#x2F;&#x2F; If the match is exactly at the edge of the range and preferParent is set,
            &#x2F;&#x2F; we want to pop upwards.
            if (_posEq(match.range.from, pos) || _posEq(match.range.to, pos)) {
                if (marks.length &gt; 1) {
                    match = marks[marks.length - 2];
                } else {
                    &#x2F;&#x2F; We must be outside the root, so there&#39;s no containing tag.
                    match = null;
                }
            }
        }
        
        return match.mark;
    }</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_getSortedTagMarks</h4>
                            <em><p>Filters the given marks to find the ones that correspond to instrumented tags,<br />sorts them by their starting position, and looks up and/or stores their ranges <br />in the given markCache.</p></em>
                            <dl>
                                    <dt>marks</dt>
                                    <dd class="label label-info pull-left">Array</dd>
                                    <dd>An array of mark objects returned by CodeMirror.</dd>
                                    <dt>markCache</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>An object that maps tag IDs to {mark, range} objects. If a mark in the marks array is already in the cache, we use the cached range info, otherwise we look up its range in CodeMirror and store it in the cache.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _getSortedTagMarks(marks, markCache) {
        marks = marks.filter(function (mark) {
            return !!mark.tagID;
        }).map(function (mark) {
            &#x2F;&#x2F; All marks should exist since we just got them from CodeMirror.
            if (!markCache[mark.tagID]) {
                markCache[mark.tagID] = {mark: mark, range: mark.find()};
            }
            return markCache[mark.tagID];
        });
        marks.sort(function (mark1, mark2) {
            return (mark1.range.from.line === mark2.range.from.line ?
                    mark1.range.from.ch - mark2.range.from.ch :
                    mark1.range.from.line - mark2.range.from.line);
        });
        
        return marks;
    }</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_getTagIDAtDocumentPos</h4>
                            <em><p>Get the instrumented tagID at the specified position. Returns -1 if<br />there are no instrumented tags at the location.<br />The _markText() function must be called before calling this function.</p>

<p>NOTE: This function is "private" for now (has a leading underscore), since<br />the API is likely to change in the future.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor to scan. </dd>
                                    <dt>pos</dt>
                                    <dd class="label label-info pull-left">{line: number,ch: number}</dd>
                                    <dd>The position to find the DOM marker for.</dd>
                                    <dt>markCache</dt>
                                        <span class="label label-optional pull-left">optional</span>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>An optional cache to look up positions of existing markers. (This avoids calling the find() operation on marks multiple times, which is expensive.)</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _getTagIDAtDocumentPos(editor, pos, markCache) {
        var match = _getMarkerAtDocumentPos(editor, pos, false, markCache);

        return (match) ? match.tagID : -1;
    }</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_hasAncestorWithID</h4>
                            <em><p>Returns true if the given node has an ancestor whose tagID is the given ID.</p></em>
                            <dl>
                                    <dt>node</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>A node from an HTMLSimpleDOM structure.</dd>
                                    <dt>id</dt>
                                    <dd class="label label-info pull-left">number</dd>
                                    <dd>The ID of the tag to check for.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _hasAncestorWithID(node, id) {
        var ancestor = node.parent;
        while (ancestor &amp;&amp; ancestor.tagID !== id) {
            ancestor = ancestor.parent;
        }
        return !!ancestor;
    }</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_markTags</h4>
                            <em><p>Recursively walks the SimpleDOM starting at node and marking<br />all tags in the CodeMirror instance. The more useful interface<br />is the _markTextFromDOM function which clears existing marks<br />before calling this function to create new ones.</p></em>
                            <dl>
                                    <dt>cm</dt>
                                    <dd class="label label-info pull-left">CodeMirror</dd>
                                    <dd>CodeMirror instance in which to mark tags</dd>
                                    <dt>node</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>SimpleDOM node to use as the root for marking</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _markTags(cm, node) {
        node.children.forEach(function (childNode) {
            if (childNode.isElement()) {
                _markTags(cm, childNode);
            }
        });
        var mark = cm.markText(node.startPos, node.endPos);
        mark.tagID = node.tagID;
    }</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_markText</h4>
                            <em><p>Mark the text for the specified editor. Either scanDocument() or <br />generateInstrumentedHTML() must be called before this function<br />is called.</p>

<p>NOTE: This function is "private" for now (has a leading underscore), since<br />the API is likely to change in the future.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor whose text should be marked.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _markText(editor) {
        var cache = _cachedValues[editor.document.file.fullPath],
            dom = cache &amp;&amp; cache.dom;
        
        if (!dom) {
            console.error(&quot;Couldn&#39;t find the dom for &quot; + editor.document.file.fullPath);
            return;
        }
        
        _markTextFromDOM(editor, dom);
    }</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_markTextFromDOM</h4>
                            <em><p>Clears the marks from the document and creates new ones.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>Editor object holding this document</dd>
                                    <dt>dom</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>SimpleDOM root object that contains the parsed structure</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _markTextFromDOM(editor, dom) {
        var cm = editor._codeMirror;
        
        &#x2F;&#x2F; Remove existing marks
        var marks = cm.getAllMarks();
        cm.operation(function () {
            marks.forEach(function (mark) {
                if (mark.hasOwnProperty(&quot;tagID&quot;)) {
                    mark.clear();
                }
            });
        });
                
        &#x2F;&#x2F; Mark
        _markTags(cm, dom);
    }</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_posEq</h4>
                            <em><p>Checks if two CodeMirror-style {line, ch} positions are equal.</p></em>
                            <dl>
                                    <dt>pos1</dt>
                                    <dd class="label label-info pull-left">{line: number,ch: number}</dd>
                                    <dd></dd>
                                    <dt>pos2</dt>
                                    <dd class="label label-info pull-left">{line: number,ch: number}</dd>
                                    <dd></dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _posEq(pos1, pos2) {
        return pos1 &amp;&amp; pos2 &amp;&amp; pos1.line === pos2.line &amp;&amp; pos1.ch === pos2.ch;
    }</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_processBrowserSimpleDOM</h4>
                            <em><p>Add SimpleDOMBuilder metadata to browser DOM tree JSON representation</p></em>
                            <dl>
                                    <dt>root</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd></dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _processBrowserSimpleDOM(browserRoot, editorRootTagID) {
        var nodeMap         = {},
            root;
        
        function _processElement(elem) {
            elem.tagID = elem.attributes[&quot;data-brackets-id&quot;];
            
            &#x2F;&#x2F; remove data-brackets-id attribute for diff
            delete elem.attributes[&quot;data-brackets-id&quot;];
            
            elem.children.forEach(function (child) {
                &#x2F;&#x2F; set parent
                child.parent = elem;
                
                if (child.isElement()) {
                    _processElement(child);
                } else if (child.isText()) {
                    child.update();
                    child.tagID = HTMLSimpleDOM.getTextNodeID(child);
                    
                    nodeMap[child.tagID] = child;
                }
            });
            
            elem.update();
            
            nodeMap[elem.tagID] = elem;

            &#x2F;&#x2F; Choose the root element based on the root tag in the editor.
            &#x2F;&#x2F; The browser may insert html, head and body elements if missing.
            if (elem.tagID === editorRootTagID) {
                root = elem;
            }
        }
        
        _processElement(browserRoot);

        root = root || browserRoot;
        root.nodeMap = nodeMap;

        return root;
    }</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_removeDocFromCache</h4>
                            <em><p>Removes the cached information (DOM, timestamp, etc.) used by HTMLInstrumentation<br />for the given document.</p></em>
                            <dl>
                                    <dt>event</dt>
                                    <dd class="label label-info pull-left">$.Event</dd>
                                    <dd>(unused)</dd>
                                    <dt>document</dt>
                                    <dd class="label label-info pull-left">Document</dd>
                                    <dd>The document to clear from the cache.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _removeDocFromCache(evt, document) {
        if (_cachedValues.hasOwnProperty(document.file.fullPath)) {
            delete _cachedValues[document.file.fullPath];
            $(document).off(&quot;.htmlInstrumentation&quot;);
        }
    }</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_resetCache</h4>
                            <em><p>Clear the DOM cache. For unit testing only.</p></em>
                            <dl>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _resetCache() {
        _cachedValues = {};
    }

    &#x2F;&#x2F; private methods
    exports._markText                   = _markText;
    exports._getMarkerAtDocumentPos     = _getMarkerAtDocumentPos;
    exports._getTagIDAtDocumentPos      = _getTagIDAtDocumentPos;
    exports._markTextFromDOM            = _markTextFromDOM;
    exports._updateDOM                  = _updateDOM;
    exports._allowIncremental           = allowIncremental;
    exports._getBrowserDiff             = _getBrowserDiff;
    exports._resetCache                 = _resetCache;
    
    &#x2F;&#x2F; public API
    exports.scanDocument                = scanDocument;
    exports.generateInstrumentedHTML    = generateInstrumentedHTML;
    exports.getUnappliedEditList        = getUnappliedEditList;
});</code></pre>
                        </div>
                        <div class="member private public">
                            <span class="pull-right scope">
                                Private
                                Public API
                            </span>
                            <h4>_updateDOM</h4>
                            <em><p>Builds a new DOM for the current state of the editor, diffs it against the<br />previous DOM, and generates a DOM edit list that can be used to replay the<br />diffs in the browser.</p></em>
                            <dl>
                                    <dt>previousDOM</dt>
                                    <dd class="label label-info pull-left">Object</dd>
                                    <dd>The HTMLSimpleDOM corresponding to the previous state of the editor. Note that in the case of an incremental edit, this will be mutated to create the new DOM (by swapping out the subtree corresponding to the changed portion).</dd>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor containing the instrumented HTML.</dd>
                                    <dt>changeList</dt>
                                        <span class="label label-optional pull-left">optional</span>
                                    <dd class="label label-info pull-left">Array</dd>
                                    <dd>If specified, a CodeMirror changelist reflecting all the text changes in the editor since previousDOM was built. If specified, we will attempt to do an incremental update (although we might fall back to a full update in various cases). If not specified, we will always do a full update.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function _updateDOM(previousDOM, editor, changeList) {
        if (!allowIncremental) {
            changeList = undefined;
        }
        var updater = new DOMUpdater(previousDOM, editor, changeList);
        var result = updater.update();
        if (!result) {
            return { errors: updater.errors };
        }
        
        var edits = HTMLDOMDiff.domdiff(result.oldSubtree, result.newSubtree);
        
        &#x2F;&#x2F; We&#39;re done with the nodeMap that was added to the subtree by the updater.
        if (result.newSubtree !== result.newDOM) {
            delete result.newSubtree.nodeMap;
        }
        
        return {
            dom: result.newDOM,
            edits: edits,
            _wasIncremental: updater.isIncremental &#x2F;&#x2F; for unit tests only
        };
    }</code></pre>
                        </div>
                        <div class="member public">
                            <span class="pull-right scope">
                                
                                Public API
                            </span>
                            <h4>generateInstrumentedHTML</h4>
                            <em><p>Generate instrumented HTML for the specified editor's document, and mark the associated tag <br />ranges in the editor. Each tag has a "data-brackets-id" attribute with a unique ID for its <br />value. For example, "<div>" becomes something like "<div data-brackets-id='45'>". The attribute <br />value is just a number that is guaranteed to be unique. </p>

<p>Also stores marks in the given editor that correspond to the tag ranges. These marks are used<br />to track the DOM structure for in-browser highlighting and live HTML updating.</p>

<p>This only needs to be done once on load of a document. As the document is edited in memory,<br />the instrumentation is kept up to date via the diffs and edits that are generated on change<br />events. Call this again only if you want to do a full re-sync of the editor's DOM state.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor whose document we're instrumenting, and which we should mark ranges in.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function generateInstrumentedHTML(editor) {
        var doc = editor.document,
            dom = scanDocument(doc),
            orig = doc.getText(),
            gen = &quot;&quot;,
            lastIndex = 0;
        
        if (!dom) {
            return null;
        }
        
        &#x2F;&#x2F; Ensure that the marks in the editor are up to date with respect to the given DOM.
        _markTextFromDOM(editor, dom);
        
        &#x2F;&#x2F; Walk through the dom nodes and insert the &#39;data-brackets-id&#39; attribute at the
        &#x2F;&#x2F; end of the open tag        
        function walk(node) {
            if (node.tag) {
                var attrText = &quot; data-brackets-id=&#39;&quot; + node.tagID + &quot;&#39;&quot;;
                
                &#x2F;&#x2F; Insert the attribute as the first attribute in the tag.
                var insertIndex = node.start + node.tag.length + 1;
                gen += orig.substr(lastIndex, insertIndex - lastIndex) + attrText;
                lastIndex = insertIndex;
            }
            
            if (node.isElement()) {
                node.children.forEach(walk);
            }
        }
        
        walk(dom);
        gen += orig.substr(lastIndex);
        
        return gen;
    }</code></pre>
                        </div>
                        <div class="member public">
                            <span class="pull-right scope">
                                
                                Public API
                            </span>
                            <h4>getUnappliedEditList</h4>
                            <em><p>Calculates the DOM edits that are needed to update the browser from the state the<br />editor was in the last time that scanDocument(), getInstrumentedHTML(), or<br />getUnappliedEditList() was called (whichever is most recent). Caches this state so<br />it can be used as the base state for the next getUnappliedEditList().</p>

<p>For simple text edits, this update is done quickly and incrementally. For structural<br />edits (edits that change the DOM structure or add/remove attributes), the update<br />requires a full reparse. </p>

<p>If the document currently contains invalid HTML, no edits will be generated until <br />getUnappliedEditList() is called when the document is valid, at which point the edits <br />will reflect all the changes needed to catch the browser up with all the edits <br />made while the document was invalid.</p></em>
                            <dl>
                                    <dt>editor</dt>
                                    <dd class="label label-info pull-left">Editor</dd>
                                    <dd>The editor containing the instrumented HTML</dd>
                                    <dt>changeList</dt>
                                    <dd class="label label-info pull-left">Array</dd>
                                    <dd>A CodeMirror change list describing the text changes made in the editor since the last update. If specified, we will attempt to do an incremental update.</dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function getUnappliedEditList(editor, changeList) {
        var cachedValue = _cachedValues[editor.document.file.fullPath];
        
        &#x2F;&#x2F; We might not have a previous DOM if the document was empty before this edit.
        if (!cachedValue || !cachedValue.dom || _cachedValues[editor.document.file.fullPath].invalid) {
            &#x2F;&#x2F; We were in an invalid state, so do a full rebuild.
            changeList = null;
        }
        
        var result = _updateDOM(cachedValue &amp;&amp; cachedValue.dom, editor, changeList);
        
        if (!result.errors) {
            _cachedValues[editor.document.file.fullPath] = {
                timestamp: editor.document.diskTimestamp,
                dom: result.dom,
                dirty: false
            };
            return { edits: result.edits };
        } else {
            if (cachedValue) {
                cachedValue.invalid = true;
            }
            return { errors: result.errors };
        }
    }</code></pre>
                        </div>
                        <div class="member public">
                            <span class="pull-right scope">
                                
                                Public API
                            </span>
                            <h4>scanDocument</h4>
                            <em><p>Parses the document, returning an HTMLSimpleDOM structure and caching it as the<br />initial state of the document. Will return a cached copy of the DOM if the<br />document hasn't changed since the last time scanDocument was called.</p>

<p>This is called by generateInstrumentedHTML(), but it can be useful to call it<br />ahead of time so the DOM is cached and doesn't need to be rescanned when the<br />instrumented HTML is requested by the browser.</p></em>
                            <dl>
                                    <dt>doc</dt>
                                    <dd class="label label-info pull-left">Document</dd>
                                    <dd>The doc to scan. </dd>
                            </dl>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>function scanDocument(doc) {
        if (!_cachedValues.hasOwnProperty(doc.file.fullPath)) {
            $(doc).on(&quot;change.htmlInstrumentation&quot;, function () {
                if (_cachedValues[doc.file.fullPath]) {
                    _cachedValues[doc.file.fullPath].dirty = true;
                }
            });
            
            &#x2F;&#x2F; Assign to cache, but don&#39;t set a value yet
            _cachedValues[doc.file.fullPath] = null;
        }
        
        var cachedValue = _cachedValues[doc.file.fullPath];
        if (!doc.isDirty &amp;&amp; cachedValue &amp;&amp; !cachedValue.dirty &amp;&amp; cachedValue.timestamp === doc.diskTimestamp) {
            return cachedValue.dom;
        }
        
        var text = doc.getText(),
            dom = HTMLSimpleDOM.build(text);
        
        if (dom) {
            &#x2F;&#x2F; Cache results
            _cachedValues[doc.file.fullPath] = {
                timestamp: doc.diskTimestamp,
                dom: dom,
                dirty: false
            };
        }
        
        return dom;
    }</code></pre>
                        </div>
                        
                    </section>
                    
                    <section id="classes">
                        <h2>Classes</h2>
                        
                            <div class="well">
                                <div class="member public">
                                    <span class="pull-right scope">
                                        Constructor
                                    </span>
                                    <h4>DOMUpdater</h4>
                                    <em><p>Subclass of HTMLSimpleDOM.Builder that builds an updated DOM after changes have been made,<br />and maps nodes from the new DOM to the old DOM by tag ID. For non-structural edits, avoids reparsing<br />the whole editor. Also updates marks in the editor based on the new DOM state.</p></em>
                                    <dl>
                                        <dt>previousDOM</dt>
                                        <dd class="label label-info pull-left">Object</dd>
                                        <dd>The root of the HTMLSimpleDOM tree representing a previous state of the DOM.</dd>
                                        <dt>editor</dt>
                                        <dd class="label label-info pull-left">Editor</dd>
                                        <dd>The editor containing the instrumented HTML.</dd>
                                        <dt>changeList</dt>
                                        <dd class="label label-info pull-left">Array</dd>
                                        <dd>An optional array of CodeMirror change records representing the edits the user made in the editor since previousDOM was built. If provided, and the edits are not structural, DOMUpdater will do a fast incremental reparse. If not provided, or if one of the edits changes the DOM structure, DOMUpdater will reparse the whole DOM.</dd>
                                    </dl>
                                    
                                    <button class="btn btn-small show-code">Show code</button>
                                    <pre class="code"><code>function DOMUpdater(previousDOM, editor, changeList) {
        var text, startOffset = 0, startOffsetPos;

        this.isIncremental = false;
        
        function isDangerousEdit(text) {
            &#x2F;&#x2F; We don&#39;t consider &amp; dangerous since entities only affect text content, not
            &#x2F;&#x2F; overall DOM structure.
            return (&#x2F;[&lt;&gt;\&#x2F;=\&quot;\&#39;]&#x2F;).test(text);
        }
        
        &#x2F;&#x2F; If there&#39;s more than one change, be conservative and assume we have to do a full reparse.
        if (changeList &amp;&amp; changeList.length === 1) {
            &#x2F;&#x2F; If the inserted or removed text doesn&#39;t have any characters that could change the
            &#x2F;&#x2F; structure of the DOM (e.g. by adding or removing a tag boundary), then we can do
            &#x2F;&#x2F; an incremental reparse of just the parent tag containing the edit. This should just
            &#x2F;&#x2F; be the marked range that contains the beginning of the edit range, since that position
            &#x2F;&#x2F; isn&#39;t changed by the edit.
            var change = changeList[0];
            if (!isDangerousEdit(change.text) &amp;&amp; !isDangerousEdit(change.removed)) {
                &#x2F;&#x2F; If the edit is right at the beginning or end of a tag, we want to be conservative
                &#x2F;&#x2F; and use the parent as the edit range.
                var startMark = _getMarkerAtDocumentPos(editor, change.from, true);
                if (startMark) {
                    var range = startMark.find();
                    if (range) {
                        text = editor._codeMirror.getRange(range.from, range.to);
                        this.changedTagID = startMark.tagID;
                        startOffsetPos = range.from;
                        startOffset = editor._codeMirror.indexFromPos(startOffsetPos);
                        this.isIncremental = true;
                    }
                }
            }
        }
        
        if (!this.changedTagID) {
            &#x2F;&#x2F; We weren&#39;t able to incrementally update, so just rebuild and diff everything.
            text = editor.document.getText();
        }
        
        HTMLSimpleDOM.Builder.call(this, text, startOffset, startOffsetPos);
        this.editor = editor;
        this.cm = editor._codeMirror;
        this.previousDOM = previousDOM;
    }
    
    DOMUpdater.prototype = Object.create(HTMLSimpleDOM.Builder.prototype);</code></pre>
                                </div>
            
            
                                <section class="methods">
                                    <h3>Methods 
                                        <label class="checkbox">
                                            <input class="toggle-public" type="checkbox"> Show Private Members
                                        </label>
                                    </h3>
                                    
                                    <div class="member private">
                                        <span class="pull-right scope">
                                            Private
                                            
                                        </span>
                                        <h4>_buildNodeMap</h4>
                                        <em><p>Creates a map from tagIDs to nodes in the given HTMLSimpleDOM subtree and<br />stores it on the root.</p></em>
                                        <dl>
                                            <dt>root</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>The root of an HTMLSimpleDOM tree.</dd>
                                        </dl>
                                        <dl>
                                        </dl>
                                        <button class="btn btn-small show-code">Show code</button>
                                        <pre class="code"><code>DOMUpdater.prototype._buildNodeMap = function (root) {
        var nodeMap = {};
        
        function walk(node) {
            if (node.tagID) {
                nodeMap[node.tagID] = node;
            }
            if (node.isElement()) {
                node.children.forEach(walk);
            }
        }
        
        walk(root);
        root.nodeMap = nodeMap;
    };</code></pre>
                                    </div>
                                    <div class="member private">
                                        <span class="pull-right scope">
                                            Private
                                            
                                        </span>
                                        <h4>_handleDeletions</h4>
                                        <em><p>Removes all nodes deleted between the oldSubtree and the newSubtree from the given nodeMap,<br />and clears marks associated with those nodes.</p></em>
                                        <dl>
                                            <dt>nodeMap</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>The nodeMap to update to remove deleted items.</dd>
                                            <dt>oldSubtreeMap</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>The nodeMap for the original subtree (which should be a subset of the first nodeMap).</dd>
                                            <dt>newSubtreeMap</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>The nodeMap for the new subtree.</dd>
                                        </dl>
                                        <dl>
                                        </dl>
                                        <button class="btn btn-small show-code">Show code</button>
                                        <pre class="code"><code>DOMUpdater.prototype._handleDeletions = function (nodeMap, oldSubtreeMap, newSubtreeMap) {
        var deletedIDs = [];
        Object.keys(oldSubtreeMap).forEach(function (key) {
            if (!newSubtreeMap.hasOwnProperty(key)) {
                deletedIDs.push(key);
                delete nodeMap[key];
            }
        });
        
        if (deletedIDs.length) {
            &#x2F;&#x2F; FUTURE: would be better to cache the mark for each node. Also, could
            &#x2F;&#x2F; conceivably combine this with _updateMarkedRanges().
            var marks = this.cm.getAllMarks();
            marks.forEach(function (mark) {
                if (mark.hasOwnProperty(&quot;tagID&quot;) &amp;&amp; deletedIDs.indexOf(mark.tagID) !== -1) {
                    mark.clear();
                }
            });
        }
    };</code></pre>
                                    </div>
                                    <div class="member private">
                                        <span class="pull-right scope">
                                            Private
                                            
                                        </span>
                                        <h4>_updateMarkedRanges</h4>
                                        <em><p>Updates the CodeMirror marks in the editor to reflect the new bounds of nodes in<br />the given nodeMap.</p></em>
                                        <dl>
                                            <dt>nodeMap</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>The node map from the new DOM.</dd>
                                            <dt>markCache</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>The cache of existing mark ranges built during the latest parse.</dd>
                                        </dl>
                                        <dl>
                                        </dl>
                                        <button class="btn btn-small show-code">Show code</button>
                                        <pre class="code"><code>DOMUpdater.prototype._updateMarkedRanges = function (nodeMap, markCache) {
        &#x2F;&#x2F; FUTURE: this is somewhat inefficient (getting all the marks involves passing linearly through
        &#x2F;&#x2F; the document once), but it doesn&#39;t seem to be a hotspot right now.
        var updateIDs = Object.keys(nodeMap),
            cm = this.cm,
            marks = cm.getAllMarks();
        
        cm.operation(function () {
            marks.forEach(function (mark) {
                if (mark.hasOwnProperty(&quot;tagID&quot;) &amp;&amp; nodeMap[mark.tagID]) {
                    var node = nodeMap[mark.tagID],
                        markInfo = markCache[mark.tagID];
                    &#x2F;&#x2F; If the mark&#39;s bounds already match, avoid destroying and recreating the mark,
                    &#x2F;&#x2F; since that incurs some overhead.
                    if (!(markInfo &amp;&amp; _posEq(markInfo.range.from, node.startPos) &amp;&amp; _posEq(markInfo.range.to, node.endPos))) {
                        mark.clear();
                        mark = cm.markText(node.startPos, node.endPos);
                        mark.tagID = node.tagID;
                    }
                    updateIDs.splice(updateIDs.indexOf(String(node.tagID)), 1);
                }
            });
            
            &#x2F;&#x2F; Any remaining updateIDs are new.
            updateIDs.forEach(function (id) {
                var node = nodeMap[id], mark;
                if (node.isElement()) {
                    mark = cm.markText(node.startPos, node.endPos);
                    mark.tagID = Number(id);
                }
            });
        });
    };</code></pre>
                                    </div>
                                    <div class="member">
                                        <span class="pull-right scope">
                                            
                                            
                                        </span>
                                        <h4>getID</h4>
                                        <em><p>Overrides the <code>getID</code> method to return the tag ID from the document. If a viable tag<br />ID cannot be found in the document marks, then a new ID is returned. This will also<br />assign a new ID if the tag changed between the previous and current versions of this<br />node.</p></em>
                                        <dl>
                                            <dt>newTag</dt>
                                            <dd class="label label-info pull-left">Object</dd>
                                            <dd>tag object for the current element</dd>
                                        </dl>
                                        <dl>
                                            <dt>Returns: </dt>
                                            <dd class="label label-info pull-left">int</dd>
                                            <dd>best ID</dd>
                                        </dl>
                                        <button class="btn btn-small show-code">Show code</button>
                                        <pre class="code"><code>DOMUpdater.prototype.getID = function (newTag, markCache) {
        &#x2F;&#x2F; Get the mark at the start of the tagname (not before the beginning of the tag, because that&#39;s
        &#x2F;&#x2F; actually inside the parent).
        var currentTagID = _getTagIDAtDocumentPos(this.editor, HTMLSimpleDOM._offsetPos(newTag.startPos, 1), markCache);
        
        &#x2F;&#x2F; If the new tag is in an unmarked range, or the marked range actually corresponds to an
        &#x2F;&#x2F; ancestor tag, then this must be a newly inserted tag, so give it a new tag ID.
        if (currentTagID === -1 || _hasAncestorWithID(newTag, currentTagID)) {
            currentTagID = this.getNewID();
        } else {
            &#x2F;&#x2F; If the tag has changed between the previous DOM and the new one, we assign a new ID
            &#x2F;&#x2F; so that the old tag will be deleted and the new one inserted.
            var oldNode = this.previousDOM.nodeMap[currentTagID];
            if (!oldNode || oldNode.tag !== newTag.tag) {
                currentTagID = this.getNewID();
            }
        }
        return currentTagID;
    };</code></pre>
                                    </div>
                                    <div class="member">
                                        <span class="pull-right scope">
                                            
                                            
                                        </span>
                                        <h4>update</h4>
                                        <em><p>Reparses the document (or a portion of it if we can do it incrementally).<br />Note that in an incremental update, the old DOM is actually mutated (the new<br />subtree is swapped in for the old subtree).</p></em>
                                        <dl>
                                        </dl>
                                        <dl>
                                            <dt>Returns: </dt>
                                            <dd class="label label-info pull-left">?{newDOM: Object,oldSubtree: Object,newSubtree: Object}</dd>
                                            <dd>newDOM is the full new DOM. For a full update, oldSubtree is the full old DOM and newSubtree is the same as newDOM; for an incremental update, oldSubtree is the portion of the old tree that was reparsed, newSubtree is the updated version, and newDOM is actually the same as the original DOM (with newSubtree swapped in for oldSubtree). If the document can't be parsed due to invalid HTML, returns null.</dd>
                                        </dl>
                                        <button class="btn btn-small show-code">Show code</button>
                                        <pre class="code"><code>DOMUpdater.prototype.update = function () {
        var markCache = {},
            newSubtree = this.build(true, markCache),
            result = {
                &#x2F;&#x2F; default result if we didn&#39;t identify a changed portion
                newDOM: newSubtree,
                oldSubtree: this.previousDOM,
                newSubtree: newSubtree
            };
        
        if (!newSubtree) {
            return null;
        }

        if (this.changedTagID) {
            &#x2F;&#x2F; Find the old subtree that&#39;s going to get swapped out.
            var oldSubtree = this.previousDOM.nodeMap[this.changedTagID],
                parent = oldSubtree.parent;
            
            &#x2F;&#x2F; If we didn&#39;t have a parent, then the whole tree changed anyway, so
            &#x2F;&#x2F; we&#39;ll just return the default result.
            if (parent) {
                var childIndex = parent.children.indexOf(oldSubtree);
                if (childIndex === -1) {
                    &#x2F;&#x2F; This should never happen...
                    console.error(&quot;DOMUpdater.update(): couldn&#39;t locate old subtree in tree&quot;);
                } else {
                    &#x2F;&#x2F; Swap the new subtree in place of the old subtree.
                    oldSubtree.parent = null;
                    newSubtree.parent = parent;
                    parent.children[childIndex] = newSubtree;
                    
                    &#x2F;&#x2F; Overwrite any node mappings in the parent DOM with the
                    &#x2F;&#x2F; mappings for the new subtree. We keep the nodeMap around
                    &#x2F;&#x2F; on the new subtree so that the differ can use it later.
                    $.extend(this.previousDOM.nodeMap, newSubtree.nodeMap);
                    
                    &#x2F;&#x2F; Update marked ranges for all items in the new subtree.
                    this._updateMarkedRanges(newSubtree.nodeMap, markCache);
                    
                    &#x2F;&#x2F; Build a local nodeMap for the old subtree so the differ can
                    &#x2F;&#x2F; use it.
                    this._buildNodeMap(oldSubtree);
                    
                    &#x2F;&#x2F; Clean up the info for any deleted nodes that are no longer in
                    &#x2F;&#x2F; the new tree.
                    this._handleDeletions(this.previousDOM.nodeMap, oldSubtree.nodeMap, newSubtree.nodeMap);
                    
                    &#x2F;&#x2F; Update the signatures for all parents of the new subtree.
                    var curParent = parent;
                    while (curParent) {
                        curParent.update();
                        curParent = curParent.parent;
                    }
                    
                    result.newDOM = this.previousDOM;
                    result.oldSubtree = oldSubtree;
                }
            }
        } else {
            _markTextFromDOM(this.editor, result.newDOM);
        }
        
        return result;
    };</code></pre>
                                    </div>
                                </section>
                                
                            </div>
                        
                    </section>
                    
                </div>
            </div>
        </div>
        
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>